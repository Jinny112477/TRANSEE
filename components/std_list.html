<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ข้อมูลนักศึกษา</title>
    <link rel="stylesheet" href="../src/style/std_list.css" />

    <!-- Favicon -->
    <link
      rel="icon"
      type="image/png"
      href="../src/Picture/favicon.png"
      sizes="64x64"
    />
    <link rel="shortcut icon" href="../src/Picture/favicon.png" />
    <link rel="apple-touch-icon" href="../src/Picture/favicon.png" />
    
    <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;700&display=swap" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
      rel="stylesheet"
    />
  </head>
  <body>
<div
  style="
    position: absolute;
    top: 30px;
    left: 30px;
    z-index: 1000;
  "
>
  <i
    class="bi bi-arrow-left"
    onclick="window.location.href='std_data.html'"
  ></i>
</div>
    <!-- Logo at top-right -->
<div
  style="
    position: absolute;
    top: 30px;
    right: 30px;
    z-index: 1000;
  "
>
  <img
    src="../src/Picture/Logo_TU_PINE.png"
    alt="TSE white Logo"
    style="
      height: 120px;
      object-fit: contain;
    "
  />
</div>

    <div class="container">
      <div class="header">
        <h2>ข้อมูลนักศึกษา</h2>
        <div class="search-box">
          <input
            type="text"
            id="searchInput"
            placeholder="ค้นหาชื่อหรือรหัส..."
            style="font-size: 1.1rem;"
          />
          <i class="bi bi-search"></i>
        </div>
      </div>

      <div class="student-list" id="studentList">
        <!-- Student cards will be dynamically inserted here -->
      </div>
    </div>

    <script>
      
      // Fetch student data from server
      fetch("/api/studentInfo/:year".replace(":year", new URLSearchParams(window.location.search).get("year")))
        .then((response) => response.json())
        .then((data) => {
          const studentList = document.getElementById("studentList");
          studentList.innerHTML = ""; // Clear existing cards
          data.forEach((student) => {
            const card = document.createElement("div");
            card.className = "student-card";
            card.onclick = function () {
              window.location.href = `StudentList2.html?id=${student.student_id}`;
            };
            card.innerHTML = `
            <i class="bi bi-person-circle profile-icon"></i>
            <div class="student-info">
              <div class="student-name">${student.full_name}</div>
              <div class="student-id">${student.student_id}</div>
            </div>
            
            <i class="bi bi-list menu-icon"></i>
          `;
            // <img src="${student.img}" alt="Profile" class="profile-icon" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover; margin-right: 10px;">
            studentList.appendChild(card);
          });
        })
        .catch((error) => console.error("Error fetching student data:", error));

      // document.getElementById("studentList").onclick = function () {
      //   window.location.href = "StudentList2.html";
      // };
    </script>

    <!-- Script ค้นหา -->
    <script>
      const searchInput = document.getElementById("searchInput");
      const studentList = document.getElementById("studentList");
      const cards = studentList.getElementsByClassName("student-card");

      searchInput.addEventListener("keyup", function () {
        const filter = searchInput.value.toLowerCase();
        for (let i = 0; i < cards.length; i++) {
          let name = cards[i]
            .getElementsByClassName("student-name")[0]
            .innerText.toLowerCase();
          let id = cards[i]
            .getElementsByClassName("student-id")[0]
            .innerText.toLowerCase();
          if (name.includes(filter) || id.includes(filter)) {
            cards[i].style.display = "";
          } else {
            cards[i].style.display = "none";
          }
        }
      });
    </script>
  </body>
</html>
